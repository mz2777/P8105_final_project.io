<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li>
  <a href="EDA.html">Exploratory Analysis</a>
</li>
<li>
  <a href=".html">Statistical Analysis</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny Apps
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mengyuzhang.shinyapps.io/num_wildfire/">Number of Wildfires in US</a>
    </li>
    <li>
      <a href="https://mengyuzhang.shinyapps.io/num_state/">Number of Wildfires in States</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="https://github.com/mz2777/P8105_final_project.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:&lt;mz2777@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analysis</h1>

</div>


<pre class="r"><code>## load data
fire = read_csv(&quot;./final_report/data/fire_0515.csv&quot;)

state.abb = append(state.abb, c(&quot;DC&quot;, &quot;PR&quot;))
state.name = append(state.name, c(&quot;District of Columbia&quot;, &quot;Puerto Rico&quot;))

tidy_fire = 
  fire %&gt;% 
  separate(cont_time, into = c(&quot;cont_hour&quot;,&quot;cont_min&quot;) ,sep = 2) %&gt;% 
  separate(discovery_time, into = c(&quot;disc_hour&quot;,&quot;disc_min&quot;) ,sep = 2) %&gt;% 
  mutate(cont_hour = as.numeric(cont_hour),
         cont_min = as.numeric(cont_min),
         disc_hour = as.numeric(disc_hour),
         disc_min = as.numeric(disc_min)) %&gt;% 
  # change julian days
  mutate(discovery_date = as.Date(discovery_date - 2458014.5, origin = &#39;2017-09-18&#39;),
         cont_date = as.Date(cont_date - 2458014.5, origin = &#39;2017-09-18&#39;),
         duration_day = as.numeric(difftime(cont_date, discovery_date, units = &quot;days&quot;))) %&gt;% 
  mutate(
    duration_hour = cont_hour - disc_hour,
    duration_min = cont_min - disc_min,
    duration = duration_day * 24 + duration_hour + duration_min / 60
  ) %&gt;% 
  select(-duration_day, -duration_hour,-duration_min) %&gt;% 
  mutate(fips_name = tolower(fips_name),
         fire_size_class = fct_inorder(fire_size_class),
         region = state.name[match(state, state.abb)],
         cause = as.factor(stat_cause_descr),
         cause = relevel(cause, ref = &quot;Missing/Undefined&quot;)) ## change reference level to &quot;missing/undefined&quot; for later linear models</code></pre>
<div id="association-between-duration-and-size-of-fire" class="section level2">
<h2>Association between duration and size of fire</h2>
<p>As stated previously, we noticed a trend of increased size with accumulated fire existing time. We proposed a linear model where duration and causes of fire would be associated with size of fire. There is a significant (p-value &lt; 0.001) association between duration of a fire and its size. For every hour increase in duration, the affect area would increase by 1.839 acres. In addition, certain causes will affect size of fire. There is a strong association between fires caused by lightening and increased size (p-value &lt; 0.001). Compared to fires with missing or undefined causes, fires caused by strikes would affect 194.633 acres more on average under the same duration.</p>
<pre class="r"><code>## linear model between size, duration and cause
model_1 = lm(fire_size ~ duration + cause, data = tidy_fire)

model_1 %&gt;% 
  tidy() %&gt;% 
  kable(digits = 3,
        caption = &quot;Association between duration and causes and size of fire&quot;)</code></pre>
<table>
<caption>Association between duration and causes and size of fire</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">116.207</td>
<td align="right">25.798</td>
<td align="right">4.505</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">duration</td>
<td align="right">1.839</td>
<td align="right">0.020</td>
<td align="right">90.480</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">causeArson</td>
<td align="right">-113.273</td>
<td align="right">29.845</td>
<td align="right">-3.795</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">causeCampfire</td>
<td align="right">-80.921</td>
<td align="right">34.796</td>
<td align="right">-2.326</td>
<td align="right">0.020</td>
</tr>
<tr class="odd">
<td align="left">causeChildren</td>
<td align="right">-126.738</td>
<td align="right">43.606</td>
<td align="right">-2.906</td>
<td align="right">0.004</td>
</tr>
<tr class="even">
<td align="left">causeDebris Burning</td>
<td align="right">-111.950</td>
<td align="right">28.755</td>
<td align="right">-3.893</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">causeEquipment Use</td>
<td align="right">-42.329</td>
<td align="right">34.543</td>
<td align="right">-1.225</td>
<td align="right">0.220</td>
</tr>
<tr class="even">
<td align="left">causeFireworks</td>
<td align="right">-121.090</td>
<td align="right">53.775</td>
<td align="right">-2.252</td>
<td align="right">0.024</td>
</tr>
<tr class="odd">
<td align="left">causeLightning</td>
<td align="right">194.633</td>
<td align="right">28.586</td>
<td align="right">6.809</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">causeMiscellaneous</td>
<td align="right">-123.196</td>
<td align="right">28.562</td>
<td align="right">-4.313</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">causePowerline</td>
<td align="right">19.349</td>
<td align="right">57.188</td>
<td align="right">0.338</td>
<td align="right">0.735</td>
</tr>
<tr class="even">
<td align="left">causeRailroad</td>
<td align="right">-128.338</td>
<td align="right">71.419</td>
<td align="right">-1.797</td>
<td align="right">0.072</td>
</tr>
<tr class="odd">
<td align="left">causeSmoking</td>
<td align="right">-181.467</td>
<td align="right">47.751</td>
<td align="right">-3.800</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">causeStructure</td>
<td align="right">-91.447</td>
<td align="right">95.803</td>
<td align="right">-0.955</td>
<td align="right">0.340</td>
</tr>
</tbody>
</table>
</div>
<div id="association-between-temperature-and-the-number-of-fires" class="section level2">
<h2>Association between temperature and the number of fires</h2>
<p>We are also interested to know whether there would be more fires when temperature was higher. We retrieved daily weather data using <code>rnoaa</code> package at county level. We have selected 2015 as the target year for analysis since we focused on association between number of fires each day and daily temperature. Additionally, daily temperature distribution was relatively similar across years. We have also limited analysis to counties with most fires in 2015 in states where fires happened most frequently during these 10 years (California and Texas according to previous analysis): Riverside(CA) and Dallas(TX).</p>
<pre class="r"><code>## subset the dataset to only include data from 2015 in TX and CA
fire_15 = tidy_fire %&gt;% 
  filter(state == &quot;CA&quot; | state == &quot;TX&quot;) %&gt;% 
  filter(fire_year == 2015) %&gt;% 
  drop_na(fips_code, fips_name) %&gt;% 
  mutate(county = fips_name)
  
## find top 1 county in each state with most fires in 2015
fire_15 %&gt;% 
  group_by(region, county) %&gt;% 
  summarise(count = n()) %&gt;% 
  ungroup() %&gt;% 
  group_by(region) %&gt;% 
  mutate(rank = rank(-count)) %&gt;% 
  filter(rank == 1) %&gt;% 
  select(-rank) %&gt;% 
  kable(caption = &quot;Counties with most count of fires in 2015&quot;)</code></pre>
<table>
<caption>Counties with most count of fires in 2015</caption>
<thead>
<tr class="header">
<th align="left">region</th>
<th align="left">county</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">California</td>
<td align="left">riverside</td>
<td align="right">573</td>
</tr>
<tr class="even">
<td align="left">Texas</td>
<td align="left">dallas</td>
<td align="right">612</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## subset further to focus on the above two counties
fire_15 = fire_15 %&gt;% 
  filter(county == &quot;riverside&quot; | county == &quot;dallas&quot;) %&gt;% 
  mutate(date = discovery_date)

## get a list of stations in rnoaa
stations = ghcnd_stations()

## get station id in &quot;riverside&quot; and &quot;dallas&quot;
station_id = stations %&gt;% 
  mutate(name = tolower(name)) %&gt;% 
  filter(state == &quot;CA&quot; | state == &quot;TX&quot;) %&gt;% 
  filter(str_detect(name, c(&quot;riverside&quot;, &quot;dallas&quot;)),
         last_year == 2019, 
         element == &quot;TMAX&quot;) %&gt;% 
  pull(id)

## retrieve weather data in each station in 2015
weather_15 = meteo_pull_monitors(station_id,
                                  date_min = &quot;2015-01-01&quot;, 
                                  date_max = &quot;2015-12-31&quot;,
                                  var = c(&quot;PRCP&quot;, &quot;TMAX&quot;, &quot;TMIN&quot;)) %&gt;% 
  mutate(tmax = tmax / 10,
         tmin = tmin / 10,
         tmean = (tmax + tmin) / 2,
         county = recode(id, 
                            &quot;USW00003171&quot; = &quot;riverside&quot;,
                            &quot;USW00013960&quot; = &quot;dallas&quot;))

## join the weather data with cleaned dataset
fire_15_weather = left_join(fire_15, weather_15, by = c(&quot;date&quot;, &quot;county&quot;))</code></pre>
<div id="distribution-of-mean-temperature-and-fires" class="section level3">
<h3>Distribution of mean temperature and fires</h3>
<p>The below graph illustrates distribution of daily mean temperature and number of fires per day in 2015. The points represents daily mean temperature which roughly follows a bell-shape curve. The histogram below shows number of fires per day. Both variables showed a similar pattern of distribution. In addition, precipitation is unlikely to be associated with number of fires with such insufficient data.</p>
<pre class="r"><code>p1 = fire_15_weather %&gt;% 
  ggplot(aes(x = date)) +
  geom_histogram(aes(fill = county), alpha = .8, show.legend = FALSE) +
  geom_point(aes(y = tmean * 5, size = prcp, color = county), alpha = .6) +
  geom_smooth(aes(y = tmean * 5, color = county), 
              method = &quot;loess&quot;, se = FALSE, alpha = .7, size = .8) +
  scale_y_continuous(sec.axis = sec_axis(~./5, name = &quot;Mean temperature (°C)&quot;)) +
  labs(title = &quot;Fig 1. Distribution of mean temperature and number of fires in 2015&quot;,
       x = &quot;Date&quot;,
       y = &quot;Number of fires&quot;,
       color = &quot;County&quot;,
       size = &quot;Precipitation&quot;)
  
p1</code></pre>
<p><img src="stat_analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="linear-regression" class="section level3">
<h3>Linear Regression</h3>
<p>We build a linear regression model with number of fires and mean daily temperature. There is significant association (p-value &lt; 0.001) between the two. For every 1°C increase in daily mean temperature, the average number of fires per day will increase by 0.074.</p>
<pre class="r"><code>## form a new dataset with daily number of fires
fire_15_count = fire_15 %&gt;% 
  group_by(date, county) %&gt;% 
  summarise(n = n())

## join the count dataset with weather information
fire_15_count = left_join(fire_15_count, weather_15, by = c(&quot;date&quot;, &quot;county&quot;))

## linear regression
model_2 = lm(n ~ tmean, data = fire_15_count)
model_2 %&gt;% 
  tidy() %&gt;% 
  kable(digits = 3, caption = &quot;Association between number of fires and mean temperature&quot;)</code></pre>
<table>
<caption>Association between number of fires and mean temperature</caption>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.041</td>
<td align="right">0.305</td>
<td align="right">3.409</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">tmean</td>
<td align="right">0.074</td>
<td align="right">0.013</td>
<td align="right">5.625</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
